javascript:!function(){const e=e=>new Promise((t=>{const r=new XMLHttpRequest;r.onload=()=>t(r.responseText),r.open("GET",e),r.send()})),t=e=>Array.from(e.querySelectorAll("tbody > tr")).map(n),r=e=>{switch(e.innerText.trim()){case"Unwrangleable":return"unwrangleable";case"Yes":return"yes";default:return"no"}},n=e=>{return{tag:e.querySelector("th > label").innerHTML,canonical:r(e.querySelector("td[title='canonical?']")),syn:(n=e.querySelector("td[title='metatag or synonym'] a"),a="innerHTML",null===n?null:n[a]),created:e.querySelector("td[title='created']").innerHTML,taggings:e.querySelector("td[title='taggings']").innerHTML,characters:(t=e.querySelectorAll("td[title='characters'] li a"),null===t?null:Array.from(t).map((e=>e.innerHTML)))};var t,n,a},a=e=>e.querySelector("a[rel='next']"),l=e=>new Promise((t=>setTimeout(t,e))),o=e=>`<tr><td>${e.tag}</td> <td>${e.canonical}</td> <td>${e.syn}</td> <td>${e.created}</td> <td>${e.taggings}</td> <td>${null===e.characters?null:e.characters.join("<br/>")}</td></tr>`;!async function(r){if(0===(new Date).getDay())return alert("Don't run this script on Sundays");if(/^\/tags\/No Fandom\/wrangle/.test(location.pathname))return alert("Don't run this on No Fandom");let n=1;const c=new DOMParser,i=open().document;for(i.write("<meta charset='utf-8'><table><tr>"),i.write("<style>table { border-collapse: collapse; border: 1px solid black; width: 100%; } td, th { padding: 4px; } tr:nth-child(even) { background: #eee; } th { background: #eFe; }</style>"),i.write(["tag","canonical","syn","created","taggings","characters"].map((e=>`<th>${e}</th>`)).join("")),i.write("</tr>");null!==r;){i.title=n+" pages deep",n++;const s=c.parseFromString(await e(r),"text/html");i.write(t(s).map(o).join(""));const d=a(s);r=d?d.href:null,await l(n<1e3?3e3:1e4)}i.write("</table>"),i.title="Done!",alert("Done!")}(location.href)}();
