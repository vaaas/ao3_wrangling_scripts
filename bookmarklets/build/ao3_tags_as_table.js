javascript:!function(){const e="table { border-collapse: collapse; border: 1px solid black; width: 100%; } td, th { padding: 4px; } tr:nth-child(even) { background: #eee; } th { background: #eFe; }",t=e=>new Promise(t=>{const r=new XMLHttpRequest;r.onload=(()=>t(r.responseText)),r.open("GET",e),r.send()}),r=e=>Array.from(e.querySelectorAll("tbody > tr")).map(o),n=(e,t)=>null===e?null:e[t],a=e=>{switch(e.innerText.trim()){case"Unwrangleable":return"unwrangleable";case"Yes":return"yes";default:return"no"}},l=e=>null===e?null:Array.from(e).map(e=>e.innerHTML),o=e=>({tag:e.querySelector("th > label").innerHTML,canonical:a(e.querySelector("td[title='canonical?']")),syn:n(e.querySelector("td[title='metatag or synonym'] a"),"innerHTML"),created:e.querySelector("td[title='created']").innerHTML,taggings:e.querySelector("td[title='taggings']").innerHTML,characters:l(e.querySelectorAll("td[title='characters'] li a"))}),c=e=>e.querySelector("a[rel='next']"),i=e=>new Promise(t=>setTimeout(t,e)),s=e=>`<tr><td>${e.tag}</td> <td>${e.canonical}</td> <td>${e.syn}</td> <td>${e.created}</td> <td>${e.taggings}</td> <td>${null===e.characters?null:e.characters.join("<br/>")}</td></tr>`,d=()=>0===(new Date).getDay(),u=()=>RegExp("^/tags/No Fandom/wrangle").test(location.pathname);!async function(n){if(d())return alert("Don't run this script on Sundays");if(u())return alert("Don't run this on No Fandom");let a=1;const l=new DOMParser,o=open().document;for(o.write("<meta charset='utf-8'><table><tr>"),o.write("<style>"+e+"</style>"),o.write(["tag","canonical","syn","created","taggings","characters"].map(e=>`<th>${e}</th>`).join("")),o.write("</tr>");null!==n;){o.title=`${a} pages deep`,a++;const e=l.parseFromString(await t(n),"text/html");o.write(r(e).map(s).join(""));const d=c(e);n=d?d.href:null,await i(a<1e3?3e3:1e4)}o.write("</table>"),o.title="Done!",alert("Done!")}(location.href)}();
